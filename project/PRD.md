# ezdoc äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰

## 1. é¡¹ç›®æ¦‚è¿°

**ezdoc** æ˜¯ä¸€ä¸ªåŸºäº Git ä»“åº“çš„æ–‡æ¡£ç®¡ç†ä¸æ¸²æŸ“ç³»ç»Ÿã€‚ç”¨æˆ·åœ¨ Git ä»“åº“ä¸­ä»¥ Markdown / MDX æ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œç³»ç»Ÿåœ¨æ„å»ºæ—¶è‡ªåŠ¨æ‹‰å–å†…å®¹å¹¶ç”Ÿæˆé«˜è´¨é‡çš„æ–‡æ¡£ç«™ç‚¹ã€‚

**é¡¹ç›®æ€§è´¨**ï¼šç§æœ‰é¡¹ç›®

## 2. ç›®æ ‡ç”¨æˆ·ä¸ä½¿ç”¨åœºæ™¯

| åœºæ™¯ | è¯´æ˜ |
|------|------|
| **ä¸ªäºº/å›¢é˜ŸæŠ€æœ¯æ–‡æ¡£** | API æ–‡æ¡£ã€æŠ€æœ¯æ–¹æ¡ˆã€å¼€å‘æŒ‡å—ç­‰å†…éƒ¨æŠ€æœ¯èµ„æ–™ |
| **äº§å“å¸®åŠ©ä¸­å¿ƒ** | é¢å‘ç»ˆç«¯ç”¨æˆ·çš„å¸®åŠ©æ–‡æ¡£ã€FAQã€ä½¿ç”¨æŒ‡å— |

## 3. æ ¸å¿ƒæ¶æ„

### 3.1 ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TB
    subgraph å†…å®¹å±‚["ğŸ“ å†…å®¹å±‚ï¼ˆGit ä»“åº“ï¼‰"]
        MD["Markdown æ–‡ä»¶<br/>.md"]
        MDX["MDX æ–‡ä»¶<br/>.mdx"]
        JSON["docs.json<br/>å¯¼èˆªé…ç½®"]
        ASSETS["é™æ€èµ„æº<br/>å›¾ç‰‡/æ–‡ä»¶"]
    end

    subgraph æ„å»ºå±‚["âš™ï¸ æ„å»ºå±‚ï¼ˆCI/CDï¼‰"]
        direction TB
        TRIGGER["GitHub Actions<br/>æ¨é€è§¦å‘"]
        REMARK["remark æ’ä»¶é“¾<br/>remark-gfm / remark-math<br/>remark-frontmatter"]
        REHYPE["rehype æ’ä»¶é“¾<br/>rehype-katex / rehype-pretty-code<br/>rehype-slug / rehype-autolink-headings<br/>rehype-mdx-import-media"]
        NAV["å¯¼èˆªè§£æå¼•æ“<br/>docs.json + ç›®å½•æ‰«æå›é€€"]
        SEARCH_IDX["Pagefind<br/>æœç´¢ç´¢å¼•ç”Ÿæˆ"]
        TRIGGER --> REMARK --> REHYPE
        TRIGGER --> NAV
    end

    subgraph åº”ç”¨å±‚["ğŸ–¥ï¸ åº”ç”¨å±‚ï¼ˆNext.jsï¼‰"]
        direction TB
        ROUTER["App Router<br/>SSG é™æ€ç”Ÿæˆ"]
        COMPONENTS["ç»„ä»¶æ˜ å°„<br/>mdx-components.tsx"]
        UI["UI ç»„ä»¶åº“<br/>shadcn/ui + Tailwind CSS"]
        FEATURES["åŠŸèƒ½æ¨¡å—"]
        I18N["next-intl<br/>å¤šè¯­è¨€"]
        THEME["next-themes<br/>æš—è‰²æ¨¡å¼"]
        MERMAID_C["Mermaid.js<br/>å›¾è¡¨æ¸²æŸ“"]
        FEATURES --- I18N
        FEATURES --- THEME
        FEATURES --- MERMAID_C
    end

    subgraph éƒ¨ç½²å±‚["ğŸŒ éƒ¨ç½²å±‚ï¼ˆè‡ªæœ‰æœåŠ¡å™¨ï¼‰"]
        NGINX["Nginx<br/>é™æ€æ–‡ä»¶æœåŠ¡"]
        CDN["CDN / gzip / brotli"]
        HTTPS["HTTPS"]
    end

    subgraph ç”¨æˆ·å±‚["ğŸ‘¤ ç”¨æˆ·å±‚"]
        WRITER["æ–‡æ¡£ä½œè€…<br/>ç¼–å†™ MD/MDX â†’ Git æ¨é€"]
        READER["æ–‡æ¡£è¯»è€…<br/>æµè§ˆå™¨è®¿é—®æ–‡æ¡£ç«™ç‚¹"]
    end

    WRITER -->|git push| å†…å®¹å±‚
    å†…å®¹å±‚ --> æ„å»ºå±‚
    æ„å»ºå±‚ --> åº”ç”¨å±‚
    REHYPE --> COMPONENTS
    NAV --> ROUTER
    åº”ç”¨å±‚ -->|é™æ€äº§ç‰©| éƒ¨ç½²å±‚
    SEARCH_IDX -->|æœç´¢ç´¢å¼•| éƒ¨ç½²å±‚
    éƒ¨ç½²å±‚ --> READER
```

### 3.2 ç”¨æˆ·ç®¡ç†æ–‡æ¡£æµç¨‹

```mermaid
flowchart TD
    START(("å¼€å§‹")) --> CREATE

    subgraph åˆ›å»ºé˜¶æ®µ["ğŸ“„ åˆ›å»º"]
        CREATE["åˆ›å»º/ç¼–è¾‘æ–‡æ¡£<br/>MD æˆ– MDX æ ¼å¼"]
        FRONT["ç¼–å†™ frontmatter<br/>title / description / icon"]
        CONTENT["ç¼–å†™æ–‡æ¡£æ­£æ–‡<br/>æ–‡æœ¬ / ä»£ç  / å…¬å¼ / å›¾è¡¨"]
        CREATE --> FRONT --> CONTENT
    end

    CONTENT --> NAV_UPDATE

    NAV_UPDATE{"éœ€è¦æ›´æ–°å¯¼èˆªï¼Ÿ"}
    NAV_UPDATE -->|æ˜¯| EDIT_JSON["ç¼–è¾‘ docs.json<br/>æ·»åŠ é¡µé¢åˆ°å¯¼èˆªç»“æ„"]
    NAV_UPDATE -->|å¦| LOCAL_PREVIEW
    EDIT_JSON --> LOCAL_PREVIEW

    subgraph éªŒè¯é˜¶æ®µ["ğŸ” éªŒè¯"]
        LOCAL_PREVIEW["æœ¬åœ°é¢„è§ˆ<br/>pnpm dev"]
        CHECK{"æ¸²æŸ“æ­£å¸¸ï¼Ÿ"}
        LOCAL_PREVIEW --> CHECK
        CHECK -->|å¦| FIX["ä¿®å¤å†…å®¹<br/>è¯­æ³•/ç»„ä»¶/æ ·å¼"]
        FIX --> LOCAL_PREVIEW
    end

    CHECK -->|æ˜¯| COMMIT

    subgraph æäº¤é˜¶æ®µ["ğŸ“¤ æäº¤"]
        COMMIT["git add + commit<br/>æäº¤å˜æ›´"]
        PUSH["git push<br/>æ¨é€åˆ°è¿œç¨‹ä»“åº“"]
        COMMIT --> PUSH
    end

    PUSH --> CI

    subgraph å‘å¸ƒé˜¶æ®µ["ğŸš€ å‘å¸ƒ"]
        CI["GitHub Actions è§¦å‘"]
        INSTALL["pnpm install<br/>å®‰è£…ä¾èµ–"]
        BUILD["next build<br/>ç¼–è¯‘ MD/MDX â†’ é™æ€é¡µé¢"]
        SEARCH["pagefind<br/>ç”Ÿæˆæœç´¢ç´¢å¼•"]
        DEPLOY["éƒ¨ç½²åˆ°æœåŠ¡å™¨<br/>rsync / Docker"]
        CI --> INSTALL --> BUILD --> SEARCH --> DEPLOY
        BUILD_CHECK{"æ„å»ºæˆåŠŸï¼Ÿ"}
        DEPLOY --> BUILD_CHECK
        BUILD_CHECK -->|å¦| NOTIFY_FAIL["é€šçŸ¥å¤±è´¥<br/>æ’æŸ¥é—®é¢˜"]
        NOTIFY_FAIL --> FIX
    end

    BUILD_CHECK -->|æ˜¯| LIVE["æ–‡æ¡£ç«™ç‚¹æ›´æ–°å®Œæˆ<br/>ç”¨æˆ·å¯è®¿é—®æœ€æ–°å†…å®¹"]
    LIVE --> END_(("ç»“æŸ"))
```

### 3.3 æŠ€æœ¯é€‰å‹

| å±‚é¢ | é€‰å‹ | ç†ç”± |
|------|------|------|
| å‰ç«¯æ¡†æ¶ | **Next.js (App Router)** | æˆç†Ÿçš„ React æ¡†æ¶ï¼ŒåŸç”Ÿæ”¯æŒ SSGã€MDXï¼ŒRSC æ€§èƒ½ä¼˜åŠ¿ |
| å†…å®¹æ ¼å¼ | **Markdown + MDX** | åŒæ—¶æ”¯æŒ `.md` å’Œ `.mdx`ï¼ŒæŒ‰éœ€é€‰æ‹© |
| æ¸²æŸ“ç­–ç•¥ | **SSG çº¯é™æ€å¯¼å‡º** (`output: 'export'`) | æ„å»ºæ—¶ç¼–è¯‘ï¼Œç”Ÿæˆçº¯ HTML/CSS/JSï¼Œæ— éœ€ Node.js è¿è¡Œæ—¶ |
| æ ·å¼æ–¹æ¡ˆ | **Tailwind CSS + shadcn/ui** | åŸå­åŒ– CSS + é«˜è´¨é‡æ— éšœç¢ç»„ä»¶åº“ |
| å›¾ç‰‡å¤„ç† | **æ„å»ºæ—¶é¢„å¤„ç†ï¼ˆsharpï¼‰** | çº¯é™æ€å¯¼å‡ºä¸æ”¯æŒ next/image æœåŠ¡ç«¯ä¼˜åŒ–ï¼Œæ„å»ºæ—¶é¢„å…ˆå‹ç¼© |
| éƒ¨ç½²æ–¹å¼ | **è‡ªæœ‰æœåŠ¡å™¨ï¼ˆNginx é™æ€æ‰˜ç®¡ï¼‰** | çº¯é™æ€æ–‡ä»¶æœåŠ¡ï¼Œæ— éœ€ Node.js è¿›ç¨‹ |
| åŒ…ç®¡ç†å™¨ | **pnpm** | é€Ÿåº¦å¿«ã€ç£ç›˜å ç”¨å° |

### 3.4 MDX ç¼–è¯‘é“¾è·¯

å…¨è‡ªç ”ç»„è£…æ–¹æ¡ˆï¼Œä¸ä¾èµ– Fumadocs ç­‰æ–‡æ¡£æ¡†æ¶ï¼Œæ¯ä¸ªç¯èŠ‚å®Œå…¨å¯æ§ã€‚

#### remark æ’ä»¶ï¼ˆMarkdown AST é˜¶æ®µï¼‰

| æ’ä»¶ | ä½œç”¨ |
|------|------|
| `remark-gfm` | è¡¨æ ¼ã€ä»»åŠ¡åˆ—è¡¨ã€åˆ é™¤çº¿ã€è‡ªåŠ¨é“¾æ¥ |
| `remark-math` | è¯†åˆ« `$...$` è¡Œå†…å’Œ `$$...$$` å—çº§æ•°å­¦å…¬å¼è¯­æ³• |
| `remark-frontmatter` | è§£æ YAML frontmatter å…ƒæ•°æ® |

#### rehype æ’ä»¶ï¼ˆHTML AST é˜¶æ®µï¼‰

| æ’ä»¶ | ä½œç”¨ |
|------|------|
| `rehype-katex` | å°†æ•°å­¦å…¬å¼æ¸²æŸ“ä¸º HTMLï¼ˆæ„å»ºæ—¶ç¼–è¯‘ï¼Œé›¶å®¢æˆ·ç«¯ JSï¼‰ |
| `rehype-pretty-code` | åŸºäº Shiki çš„ä»£ç è¯­æ³•é«˜äº®ï¼ˆVS Code å¼•æ“ï¼Œæ„å»ºæ—¶ç”Ÿæˆï¼‰ |
| `rehype-slug` | ä¸ºæ ‡é¢˜å…ƒç´ ç”Ÿæˆ id é”šç‚¹ |
| `rehype-autolink-headings` | ä¸ºæ ‡é¢˜æ·»åŠ å¯ç‚¹å‡»çš„é”šç‚¹é“¾æ¥ |
| `rehype-mdx-import-media` | è‡ªåŠ¨å°†å›¾ç‰‡è·¯å¾„è½¬ä¸ºé™æ€ importï¼Œæ¥å…¥ next/image ä¼˜åŒ– |

#### ç»„ä»¶æ˜ å°„ï¼ˆmdx-components.tsxï¼‰

| HTML å…ƒç´  | æ˜ å°„ä¸º | è¯´æ˜ |
|-----------|--------|------|
| `img` | `next/image` | è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–ï¼ˆå‹ç¼©ã€WebPã€æ‡’åŠ è½½ã€é˜²å¸ƒå±€åç§»ï¼‰ |
| `a` | è‡ªå®šä¹‰ Link ç»„ä»¶ | å¤–éƒ¨é“¾æ¥ `target="_blank"`ï¼Œå†…éƒ¨é“¾æ¥ç”¨ Next.js `<Link>` |
| `pre/code` | CodeBlock ç»„ä»¶ | å¤åˆ¶æŒ‰é’®ã€è¡Œå·ã€æ–‡ä»¶åæ ‡é¢˜ |
| mermaid ä»£ç å— | Mermaid ç»„ä»¶ | å®¢æˆ·ç«¯æ¸²æŸ“å›¾è¡¨ï¼ˆ`next/dynamic` + `ssr: false`ï¼‰ |

#### ç¼–è¯‘æµç¨‹æ€»è§ˆ

```
MDX/MD æºæ–‡ä»¶
  â”‚
  â”œâ”€â”€ remark é˜¶æ®µ
  â”‚   â”œâ”€â”€ remark-frontmatter   â†’ æå–å…ƒæ•°æ®
  â”‚   â”œâ”€â”€ remark-gfm           â†’ GFM æ‰©å±•è¯­æ³•
  â”‚   â””â”€â”€ remark-math          â†’ æ•°å­¦å…¬å¼æ ‡è®°
  â”‚
  â”œâ”€â”€ rehype é˜¶æ®µ
  â”‚   â”œâ”€â”€ rehype-katex                â†’ æ•°å­¦å…¬å¼ â†’ HTML
  â”‚   â”œâ”€â”€ rehype-pretty-code (Shiki)  â†’ ä»£ç é«˜äº®
  â”‚   â”œâ”€â”€ rehype-slug                 â†’ æ ‡é¢˜é”šç‚¹ id
  â”‚   â”œâ”€â”€ rehype-autolink-headings    â†’ æ ‡é¢˜é”šç‚¹é“¾æ¥
  â”‚   â””â”€â”€ rehype-mdx-import-media     â†’ å›¾ç‰‡é™æ€ import
  â”‚
  â””â”€â”€ ç»„ä»¶æ˜ å°„
      â”œâ”€â”€ img     â†’ next/image
      â”œâ”€â”€ a       â†’ æ™ºèƒ½ Link
      â”œâ”€â”€ pre     â†’ CodeBlock
      â””â”€â”€ mermaid â†’ å®¢æˆ·ç«¯ Mermaid
```

### 3.5 é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆezdoc.config.tsï¼‰

é¡¹ç›®æ ¹ç›®å½•çš„ `ezdoc.config.ts` ä½œä¸ºå”¯ä¸€é…ç½®å…¥å£ï¼Œé›†ä¸­ç®¡ç†æ‰€æœ‰å¯é…ç½®é¡¹ã€‚`next.config.mjs` å’Œå„æ¨¡å—åœ¨æ„å»ºæ—¶è¯»å–æ­¤é…ç½®ã€‚

```ts
import { defineConfig } from './src/lib/config'

export default defineConfig({
  // â”€â”€â”€ ç«™ç‚¹åŸºç¡€ä¿¡æ¯ â”€â”€â”€
  site: {
    title: 'My Docs',                    // ç«™ç‚¹æ ‡é¢˜
    description: 'é¡¹ç›®æ–‡æ¡£ä¸­å¿ƒ',           // ç«™ç‚¹æè¿°ï¼ˆç”¨äº SEOï¼‰
    logo: '/logo.svg',                    // Logo è·¯å¾„ï¼ˆç›¸å¯¹äº public/ï¼‰
    favicon: '/favicon.ico',              // Favicon è·¯å¾„
    url: 'https://docs.example.com',      // ç«™ç‚¹çº¿ä¸Šåœ°å€
    socials: {                            // ç¤¾äº¤é“¾æ¥ï¼ˆæ˜¾ç¤ºåœ¨é¡¶éƒ¨å¯¼èˆªï¼‰
      github: 'https://github.com/user/repo',
      // twitter: 'https://twitter.com/...',
      // discord: 'https://discord.gg/...',
    },
  },

  // â”€â”€â”€ æ–‡æ¡£ç›®å½•é…ç½® â”€â”€â”€
  docs: {
    dir: 'docs',                          // æ–‡æ¡£å†…å®¹æ ¹ç›®å½•ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ï¼‰
    nav: 'docs.json',                     // å¯¼èˆªé…ç½®æ–‡ä»¶åï¼ˆç›¸å¯¹äº docs.dirï¼‰
  },

  // â”€â”€â”€ ä¸»é¢˜é…ç½® â”€â”€â”€
  theme: {
    defaultMode: 'system',                // é»˜è®¤ä¸»é¢˜ï¼š'light' | 'dark' | 'system'
    primaryColor: '#3b82f6',              // ä¸»é¢˜è‰²
    // accentColor: '#8b5cf6',            // å¼ºè°ƒè‰²ï¼ˆå¯é€‰ï¼‰
  },

  // â”€â”€â”€ å¤šè¯­è¨€é…ç½® â”€â”€â”€
  i18n: {
    defaultLocale: 'zh',                  // é»˜è®¤è¯­è¨€
    locales: ['zh', 'en'],                // æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
  },

  // â”€â”€â”€ ç‰ˆæœ¬ç®¡ç† â”€â”€â”€
  versions: {
    current: 'v2',                        // å½“å‰/é»˜è®¤ç‰ˆæœ¬
    list: ['v1', 'v2'],                   // æ‰€æœ‰ç‰ˆæœ¬
  },

  // â”€â”€â”€ éƒ¨ç½²é…ç½® â”€â”€â”€
  deploy: {
    basePath: '',                         // è·¯ç”±å‰ç¼€ï¼ˆGitHub Pages éœ€è®¾ä¸º '/repo-name'ï¼‰
    output: 'out',                        // æ„å»ºè¾“å‡ºç›®å½•
  },
})
```

#### é…ç½®é¡¹è¯´æ˜

| åˆ†ç±» | å­—æ®µ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| **site** | `title` | æ˜¯ | - | ç«™ç‚¹æ ‡é¢˜ï¼Œæ˜¾ç¤ºåœ¨æµè§ˆå™¨æ ‡ç­¾å’Œå¯¼èˆªæ  |
| | `description` | å¦ | `''` | SEO æè¿°ï¼Œç”¨äº meta æ ‡ç­¾å’Œ Open Graph |
| | `logo` | å¦ | - | Logo å›¾ç‰‡è·¯å¾„ |
| | `favicon` | å¦ | `/favicon.ico` | Favicon è·¯å¾„ |
| | `url` | å¦ | - | çº¿ä¸Šåœ°å€ï¼Œç”¨äº sitemap å’Œ Open Graph |
| | `socials` | å¦ | `{}` | ç¤¾äº¤é“¾æ¥ï¼Œkey ä¸ºå¹³å°åï¼Œvalue ä¸º URL |
| **docs** | `dir` | å¦ | `'docs'` | æ–‡æ¡£å†…å®¹æ ¹ç›®å½• |
| | `nav` | å¦ | `'docs.json'` | å¯¼èˆªé…ç½®æ–‡ä»¶å |
| **theme** | `defaultMode` | å¦ | `'system'` | é»˜è®¤ä¸»é¢˜æ¨¡å¼ |
| | `primaryColor` | å¦ | `'#3b82f6'` | ä¸»é¢˜è‰²ï¼ˆå½±å“é“¾æ¥ã€æŒ‰é’®ç­‰ï¼‰ |
| **i18n** | `defaultLocale` | å¦ | `'zh'` | é»˜è®¤è¯­è¨€ |
| | `locales` | å¦ | `['zh']` | æ”¯æŒçš„è¯­è¨€åˆ—è¡¨ï¼Œå•è¯­è¨€æ—¶ä¸æ˜¾ç¤ºåˆ‡æ¢å™¨ |
| **versions** | `current` | å¦ | - | å½“å‰ç‰ˆæœ¬ï¼Œä¸é…ç½®åˆ™ä¸å¯ç”¨ç‰ˆæœ¬ç®¡ç† |
| | `list` | å¦ | `[]` | ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸ºç©ºåˆ™ä¸æ˜¾ç¤ºç‰ˆæœ¬åˆ‡æ¢å™¨ |
| **deploy** | `basePath` | å¦ | `''` | è·¯ç”±å‰ç¼€ï¼ŒGitHub Pages é¡¹ç›®ç«™ç‚¹éœ€è®¾ç½® |
| | `output` | å¦ | `'out'` | æ„å»ºè¾“å‡ºç›®å½• |

### 3.6 ç›®å½•ç»“æ„è®¾è®¡

```
ezdoc/
â”œâ”€â”€ ezdoc.config.ts          # é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆå”¯ä¸€é…ç½®å…¥å£ï¼‰
â”œâ”€â”€ docs/                    # æ–‡æ¡£å†…å®¹ç›®å½•ï¼ˆå¯é€šè¿‡é…ç½®ä¿®æ”¹ï¼‰
â”‚   â”œâ”€â”€ docs.json            # å¯¼èˆªç»“æ„é…ç½®ï¼ˆå¯é€šè¿‡é…ç½®ä¿®æ”¹æ–‡ä»¶åï¼‰
â”‚   â”œâ”€â”€ getting-started.md
â”‚   â”œâ”€â”€ guides/
â”‚   â”‚   â”œâ”€â”€ installation.md
â”‚   â”‚   â””â”€â”€ configuration.mdx
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ reference.mdx
â”œâ”€â”€ src/                     # å‰ç«¯åº”ç”¨æºç 
â”‚   â”œâ”€â”€ app/                 # Next.js App Router
â”‚   â”œâ”€â”€ components/          # UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Callout.tsx      # æç¤ºæ¡†
â”‚   â”‚   â”œâ”€â”€ Tabs.tsx         # é€‰é¡¹å¡
â”‚   â”‚   â”œâ”€â”€ CodeBlock.tsx    # ä»£ç å—å¢å¼º
â”‚   â”‚   â””â”€â”€ Mermaid.tsx      # Mermaid å›¾è¡¨ï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰
â”‚   â”œâ”€â”€ lib/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ config.ts        # é…ç½®åŠ è½½ä¸ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ mdx.ts           # MDX ç¼–è¯‘é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ docs.ts          # æ–‡æ¡£è¯»å–ä¸å¯¼èˆªç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ search.ts        # æœç´¢ç´¢å¼•æ„å»º
â”‚   â””â”€â”€ mdx-components.tsx   # MDX ç»„ä»¶æ˜ å°„
â”œâ”€â”€ public/
â”œâ”€â”€ next.config.mjs          # è¯»å– ezdoc.config.ts ç”Ÿæˆ Next.js é…ç½®
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ package.json
```

## 4. æ–‡æ¡£å¯¼èˆªç»“æ„

é‡‡ç”¨ **docs.json é…ç½® + ç›®å½•æ‰«æå›é€€** çš„æ··åˆæ¨¡å¼ã€‚

### 4.1 docs.json æ ¼å¼å®šä¹‰

```json
{
  "navigation": [
    {
      "group": "å¿«é€Ÿå¼€å§‹",
      "pages": [
        "getting-started",
        "installation"
      ]
    },
    {
      "group": "ä½¿ç”¨æŒ‡å—",
      "pages": [
        {
          "title": "é…ç½®è¯´æ˜",
          "path": "guides/configuration"
        },
        "guides/advanced"
      ]
    },
    {
      "group": "API å‚è€ƒ",
      "pages": [
        "api/reference"
      ]
    }
  ]
}
```

### 4.2 å¯¼èˆªè§£æé€»è¾‘

1. æ„å»ºæ—¶ä¼˜å…ˆè¯»å– `docs/docs.json`
2. å¦‚æœ `docs.json` ä¸å­˜åœ¨æˆ–æœªè¦†ç›–æŸäº›æ–‡ä»¶ï¼Œå›é€€åˆ°æ‰«æ `docs/` ç›®å½•
3. å›é€€æ—¶æŒ‰æ–‡ä»¶åå­—æ¯é¡ºåºæ’åˆ—ï¼Œç›®å½•ä½œä¸ºåˆ†ç»„å
4. æ¯ç¯‡æ–‡æ¡£çš„æ ‡é¢˜ä¼˜å…ˆè¯»å–æ–‡ä»¶å†…çš„ frontmatter `title` å­—æ®µï¼Œå…¶æ¬¡ç”¨æ–‡ä»¶å

## 5. å†…å®¹æ ¼å¼è§„èŒƒ

### 5.1 Frontmatter

æ¯ç¯‡æ–‡æ¡£æ”¯æŒ YAML frontmatterï¼š

```yaml
---
title: å¿«é€Ÿå¼€å§‹
description: 5 åˆ†é’Ÿä¸Šæ‰‹ ezdoc
icon: rocket
---
```

### 5.2 Markdown æ”¯æŒ

æ ‡å‡† CommonMark è¯­æ³•ï¼Œé¢å¤–æ”¯æŒï¼š
- GFMï¼ˆGitHub Flavored Markdownï¼‰ï¼šè¡¨æ ¼ã€ä»»åŠ¡åˆ—è¡¨ã€åˆ é™¤çº¿
- è¯­æ³•é«˜äº®çš„ä»£ç å—
- è‡ªåŠ¨ç”Ÿæˆçš„ç›®å½•é”šç‚¹ï¼ˆTOCï¼‰

### 5.3 MDX æ”¯æŒ

åœ¨ `.mdx` æ–‡ä»¶ä¸­å¯ç›´æ¥ä½¿ç”¨é¢„æ³¨å†Œçš„å†…ç½®ç»„ä»¶ï¼Œæ— éœ€ importï¼š

```mdx
---
title: é…ç½®è¯´æ˜
---

# é…ç½®è¯´æ˜

<Callout type="warning">
  ä¿®æ”¹é…ç½®åéœ€è¦é‡æ–°å¯åŠ¨æœåŠ¡ã€‚
</Callout>

<Tabs items={["npm", "yarn", "pnpm"]}>
  <Tab value="npm">npm install ezdoc</Tab>
  <Tab value="yarn">yarn add ezdoc</Tab>
  <Tab value="pnpm">pnpm add ezdoc</Tab>
</Tabs>
```

## 6. å†…å®¹æ¸²æŸ“èƒ½åŠ›

### 6.1 å›¾ç‰‡

- Markdown æ ‡å‡†å›¾ç‰‡è¯­æ³• `![alt](url)` è‡ªåŠ¨æ˜ å°„åˆ° `next/image`
- æ”¯æŒæœ¬åœ°å›¾ç‰‡å’Œè¿œç¨‹å›¾ç‰‡
- è‡ªåŠ¨ä¼˜åŒ–ï¼šå‹ç¼©ã€WebP è½¬æ¢ã€å“åº”å¼å°ºå¯¸ã€æ‡’åŠ è½½
- é˜²æ­¢ CLSï¼ˆç´¯ç§¯å¸ƒå±€åç§»ï¼‰

### 6.2 é“¾æ¥

- å†…éƒ¨é“¾æ¥è‡ªåŠ¨ä½¿ç”¨ Next.js `<Link>` ç»„ä»¶ï¼Œå®ç°å®¢æˆ·ç«¯è·¯ç”±è·³è½¬ï¼ˆæ— åˆ·æ–°ï¼‰
- å¤–éƒ¨é“¾æ¥è‡ªåŠ¨æ·»åŠ  `target="_blank"` å’Œ `rel="noopener noreferrer"`
- æ ‡é¢˜é”šç‚¹é“¾æ¥ï¼šæ¯ä¸ªæ ‡é¢˜è‡ªåŠ¨ç”Ÿæˆ id å’Œå¯ç‚¹å‡»çš„é”šç‚¹å›¾æ ‡

### 6.3 æ•°å­¦å…¬å¼

åŸºäº KaTeXï¼Œæ„å»ºæ—¶ç¼–è¯‘ä¸º HTMLï¼Œé›¶å®¢æˆ·ç«¯ JS å¼€é”€ã€‚

è¡Œå†…å…¬å¼ï¼š

```markdown
è´¨èƒ½æ–¹ç¨‹ $E = mc^2$ æ˜¯ç‰©ç†å­¦çš„åŸºç¡€å…¬å¼ã€‚
```

å—çº§å…¬å¼ï¼š

```markdown
$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$
```

### 6.4 Mermaid å›¾è¡¨

åœ¨ fenced code block ä¸­ä½¿ç”¨ `mermaid` è¯­è¨€æ ‡è®°ï¼Œå®¢æˆ·ç«¯æ¸²æŸ“ä¸º SVG å›¾è¡¨ã€‚

æ”¯æŒçš„å›¾è¡¨ç±»å‹ï¼šæµç¨‹å›¾ã€æ—¶åºå›¾ã€ç”˜ç‰¹å›¾ã€ç±»å›¾ã€çŠ¶æ€å›¾ã€ER å›¾ã€é¥¼å›¾ç­‰ã€‚

~~~markdown
```mermaid
graph TD
    A[å¼€å§‹] --> B{æ¡ä»¶åˆ¤æ–­}
    B -->|æ˜¯| C[æ‰§è¡Œæ“ä½œ]
    B -->|å¦| D[ç»“æŸ]
    C --> D
```
~~~

æš—è‰²æ¨¡å¼ä¸‹è‡ªåŠ¨åˆ‡æ¢ Mermaid ä¸»é¢˜ã€‚

### 6.5 è¡¨æ ¼

GFM æ ‡å‡†è¡¨æ ¼è¯­æ³•ï¼Œæ”¯æŒå¯¹é½æ–¹å¼ï¼š

```markdown
| å·¦å¯¹é½ | å±…ä¸­ | å³å¯¹é½ |
|:-------|:----:|-------:|
| å†…å®¹   | å†…å®¹ |   å†…å®¹ |
```

## 7. å†…ç½®ç»„ä»¶

### 7.1 Callout / æç¤ºæ¡†

æ”¯æŒçš„ç±»å‹ï¼š`info` | `warning` | `error` | `tip`

```mdx
<Callout type="info">è¿™æ˜¯ä¸€æ¡æç¤ºä¿¡æ¯ã€‚</Callout>
<Callout type="warning">è¯·æ³¨æ„æ­¤æ“ä½œä¸å¯é€†ã€‚</Callout>
<Callout type="error">æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚</Callout>
<Callout type="tip">ä½ å¯ä»¥ä½¿ç”¨å¿«æ·é”®åŠ é€Ÿæ“ä½œã€‚</Callout>
```

### 7.2 Tabs / é€‰é¡¹å¡

ç”¨äºå¤šè¯­è¨€ä»£ç ç¤ºä¾‹ã€å¤šå¹³å°è¯´æ˜ç­‰åœºæ™¯ï¼š

```mdx
<Tabs items={["JavaScript", "Python"]}>
  <Tab value="JavaScript">console.log('hello')</Tab>
  <Tab value="Python">print('hello')</Tab>
</Tabs>
```

### 7.3 CodeBlock / ä»£ç å—å¢å¼º

åŸºäº fenced code block è‡ªåŠ¨å¢å¼ºï¼š
- è¯­æ³•é«˜äº®ï¼ˆåŸºäº Shikiï¼Œæ„å»ºæ—¶ç”Ÿæˆï¼Œé›¶ JSï¼‰
- æ˜¾ç¤ºè¡Œå·
- å¤åˆ¶æŒ‰é’®
- æ–‡ä»¶åæ ‡é¢˜æ˜¾ç¤º

~~~markdown
```js title="example.js" showLineNumbers
function hello() {
  console.log('hello ezdoc')
}
```
~~~

## 8. åŠŸèƒ½éœ€æ±‚

### 8.1 å…¨æ–‡æœç´¢

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ–¹æ¡ˆ | æ„å»ºåè‡ªåŠ¨æ‰«æ HTML ç”Ÿæˆç´¢å¼•ï¼Œå®¢æˆ·ç«¯æŒ‰éœ€åŠ è½½ç´¢å¼•åˆ†ç‰‡ |
| æŠ€æœ¯ | **Pagefind** |
| èŒƒå›´ | æ ‡é¢˜ + æ­£æ–‡å†…å®¹ |
| äº¤äº’ | å¿«æ·é”®ï¼ˆCtrl/Cmd + Kï¼‰å”¤èµ·æœç´¢æ¡†ï¼Œå®æ—¶æ˜¾ç¤ºç»“æœ |
| ä¼˜åŠ¿ | é›¶é…ç½®ã€ä½å¸¦å®½ã€æ”¯æŒå¤§è§„æ¨¡æ–‡æ¡£ |

### 8.2 å¤šè¯­è¨€ / i18n

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æŠ€æœ¯ | **next-intl** |
| ç›®å½•ç»“æ„ | `docs/zh/`ã€`docs/en/` æŒ‰è¯­è¨€åˆ†ç›®å½• |
| åˆ‡æ¢æ–¹å¼ | é¡¶éƒ¨å¯¼èˆªè¯­è¨€åˆ‡æ¢å™¨ |
| é»˜è®¤è¯­è¨€ | ä¸­æ–‡ï¼ˆzhï¼‰ |
| è·¯ç”±è§„åˆ™ | `/zh/getting-started`ã€`/en/getting-started` |

### 8.3 æš—è‰²æ¨¡å¼

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æŠ€æœ¯ | **next-themes** |
| æ¨¡å¼ | äº®è‰² / æš—è‰² / è·Ÿéšç³»ç»Ÿï¼Œä¸‰æ¡£åˆ‡æ¢ |
| å®ç° | CSS å˜é‡ + Tailwind `dark:` å‰ç¼€ |
| æŒä¹…åŒ– | localStorage è®°ä½ç”¨æˆ·é€‰æ‹© |

### 8.4 ç‰ˆæœ¬ç®¡ç†

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ–¹æ¡ˆ | æŒ‰ç›®å½•åŒºåˆ†ç‰ˆæœ¬ï¼ˆ`docs/v1/`ã€`docs/v2/`ï¼‰ |
| åˆ‡æ¢æ–¹å¼ | é¡¶éƒ¨å¯¼èˆªç‰ˆæœ¬é€‰æ‹©å™¨ |
| é»˜è®¤ç‰ˆæœ¬ | æœ€æ–°ç‰ˆæœ¬ |
| è·¯ç”±è§„åˆ™ | `/v2/getting-started`ã€`/v1/getting-started` |

## 9. é¡µé¢å¸ƒå±€

### 9.1 æ•´ä½“ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¡¶éƒ¨å¯¼èˆªæ ï¼šLogo | æœç´¢ | ç‰ˆæœ¬ | è¯­è¨€ | ä¸»é¢˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                        â”‚          â”‚
â”‚  å·¦ä¾§    â”‚      æ–‡æ¡£æ­£æ–‡åŒºåŸŸ       â”‚  å³ä¾§    â”‚
â”‚  å¯¼èˆªæ   â”‚                        â”‚  TOC     â”‚
â”‚          â”‚                        â”‚  ç›®å½•    â”‚
â”‚          â”‚                        â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åº•éƒ¨ï¼šä¸Šä¸€ç¯‡ / ä¸‹ä¸€ç¯‡å¯¼èˆª                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 å“åº”å¼è®¾è®¡

- **æ¡Œé¢ç«¯ï¼ˆ>1024pxï¼‰**ï¼šä¸‰æ å¸ƒå±€ï¼Œå·¦ä¾§å¯¼èˆª + æ­£æ–‡ + å³ä¾§ TOC
- **å¹³æ¿ç«¯ï¼ˆ768-1024pxï¼‰**ï¼šéšè—å³ä¾§ TOCï¼Œå·¦ä¾§å¯¼èˆªå¯æŠ˜å 
- **ç§»åŠ¨ç«¯ï¼ˆ<768pxï¼‰**ï¼šæ±‰å ¡èœå•ï¼Œå•æ æ­£æ–‡

## 10. éƒ¨ç½²æ–¹æ¡ˆ

é‡‡ç”¨**åŒ workflow å¹¶è¡Œéƒ¨ç½²**ï¼šGitHub Pages ä½œä¸ºå…¬å¼€ç¤ºä¾‹ç«™ï¼Œè‡ªæœ‰æœåŠ¡å™¨ä½œä¸ºç”Ÿäº§ç¯å¢ƒã€‚

```mermaid
graph LR
    PUSH["git push to main"] --> W1["Workflow 1<br/>GitHub Pages"]
    PUSH --> W2["Workflow 2<br/>è‡ªæœ‰æœåŠ¡å™¨"]

    W1 --> |"basePath: /ezdoc"| GP["GitHub Pages<br/>coldplay-now.github.io/ezdoc"]
    W2 --> |"basePath: ç©º"| SV["Nginx æœåŠ¡å™¨<br/>docs.example.com"]
```

### 10.1 Workflow 1ï¼šGitHub Pagesï¼ˆç¤ºä¾‹ç«™ï¼‰

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| è§¦å‘æ¡ä»¶ | push åˆ° main åˆ†æ”¯ |
| basePath | `/ezdoc`ï¼ˆé¡¹ç›®ç«™ç‚¹å‰ç¼€ï¼‰ |
| éƒ¨ç½²ç›®æ ‡ | GitHub Pagesï¼ˆ`gh-pages` åˆ†æ”¯ï¼‰ |
| è®¿é—®åœ°å€ | `https://coldplay-now.github.io/ezdoc/` |
| ç”¨é€” | å…¬å¼€æ¼”ç¤ºã€æ•ˆæœé¢„è§ˆ |

### 10.2 Workflow 2ï¼šè‡ªæœ‰æœåŠ¡å™¨ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| è§¦å‘æ¡ä»¶ | push åˆ° main åˆ†æ”¯ï¼ˆæˆ–æ‰“ release æ ‡ç­¾ï¼‰ |
| basePath | ç©ºï¼ˆåŸŸåæ ¹è·¯å¾„ï¼‰ |
| éƒ¨ç½²ç›®æ ‡ | rsync over SSH åˆ° Nginx æœåŠ¡å™¨ |
| è®¿é—®åœ°å€ | `https://docs.example.com/` |
| ç”¨é€” | æ­£å¼ç”Ÿäº§ç¯å¢ƒ |

### 10.3 æ„å»ºæµç¨‹

ä¸¤ä¸ª workflow å…±äº«ç›¸åŒçš„æ„å»ºæ­¥éª¤ï¼Œä»… `basePath` ä¸åŒï¼š

```
pnpm install
  â†’ ezdoc.config.ts è¯»å–é…ç½®ï¼ˆbasePath ç”±ç¯å¢ƒå˜é‡è¦†ç›–ï¼‰
  â†’ next buildï¼ˆè¾“å‡ºåˆ° out/ï¼‰
  â†’ pagefind --site out/ï¼ˆç”Ÿæˆæœç´¢ç´¢å¼•ï¼‰
  â†’ éƒ¨ç½²åˆ°ç›®æ ‡ç¯å¢ƒ
```

### 10.4 æœåŠ¡å™¨è¦æ±‚

- Nginx é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼ˆæ— éœ€ Node.js è¿è¡Œæ—¶ï¼‰
- å¯ç”¨ gzip/brotli å‹ç¼©
- é…ç½® HTTPSï¼ˆLet's Encryptï¼‰
- è¯¦ç»†éƒ¨ç½²è§„æ ¼è§ `docs/deployment.md`

## 11. æŠ€æœ¯æ ˆæ€»è§ˆ

| å±‚é¢ | æ–¹æ¡ˆ |
|------|------|
| æ¡†æ¶ | Next.js (App Router) |
| è¯­è¨€ | TypeScript |
| æ ·å¼ | Tailwind CSS |
| UI ç»„ä»¶ | shadcn/ui (Radix UI) |
| MDX ç¼–è¯‘ | next-mdx-remote |
| è¯­æ³•é«˜äº® | Shiki (rehype-pretty-code) |
| æ•°å­¦å…¬å¼ | remark-math + rehype-katex |
| å›¾è¡¨ | Mermaid.jsï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰ |
| å›¾ç‰‡ä¼˜åŒ– | æ„å»ºæ—¶ sharp é¢„å¤„ç† + rehype-mdx-import-media |
| æœç´¢ | Pagefind |
| å¤šè¯­è¨€ | next-intl |
| æš—è‰²æ¨¡å¼ | next-themes |
| åŒ…ç®¡ç† | pnpm |
| CI/CD | GitHub Actions |

## 12. é‡Œç¨‹ç¢‘

### P0 - æ ¸å¿ƒåŠŸèƒ½

- é¡¹ç›®åˆå§‹åŒ–ï¼ˆNext.js + Tailwind + shadcn/uiï¼‰
- `ezdoc.config.ts` é…ç½®æ–‡ä»¶ä½“ç³»
- MDX ç¼–è¯‘é“¾è·¯æ­å»ºï¼ˆremark/rehype æ’ä»¶å…¨é“¾è·¯ï¼‰
- docs.json å¯¼èˆªè§£æ + ç›®å½•æ‰«æå›é€€
- Markdown / MDX æ¸²æŸ“ï¼ˆå›¾ç‰‡ã€é“¾æ¥ã€è¡¨æ ¼ï¼‰
- æ•°å­¦å…¬å¼æ¸²æŸ“ï¼ˆKaTeXï¼‰
- Mermaid å›¾è¡¨æ¸²æŸ“
- å†…ç½®ç»„ä»¶ï¼šCalloutã€Tabsã€CodeBlock
- åŸºç¡€é¡µé¢å¸ƒå±€ï¼ˆä¸‰æ  + å“åº”å¼ï¼‰
- æš—è‰²æ¨¡å¼

### P1 - å¢å¼ºåŠŸèƒ½

- å…¨æ–‡æœç´¢ï¼ˆPagefindï¼‰
- å¤šè¯­è¨€æ”¯æŒï¼ˆnext-intlï¼‰
- ä¸Šä¸€ç¯‡/ä¸‹ä¸€ç¯‡å¯¼èˆª
- SEO ä¼˜åŒ–ï¼ˆsitemapã€meta tagsã€Open Graphï¼‰
- GitHub Pages éƒ¨ç½² workflow
- è‡ªæœ‰æœåŠ¡å™¨éƒ¨ç½² workflow

### P2 - è¿›é˜¶åŠŸèƒ½

- ç‰ˆæœ¬ç®¡ç†
- æ›´å¤šå†…ç½®ç»„ä»¶æ‰©å±•
